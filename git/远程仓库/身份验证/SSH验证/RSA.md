# RSA
> 是目前使用最广泛的一种非对称加密技术.

<br><br>

## 目录

1. [RSA背景介绍]()
2. [RSA基本原理简介]()
3. [复杂度分析]()

<br><br>

### 一、RSA背景介绍：

1. RSA公钥加密算法于1977年由Ron Rivest、Adi Shamir和Leonard Adleman三人一起提出.
  - 算法就是由三人名字首字母命名.
2. 已被ISO推荐为公钥数据加密标准，使用非常广泛，毫不夸张地说，只要有计算机网络的地方就有RSA算法.
3. 能够抵抗到目前为止已知的绝大多数密码攻击：
  1. RSA密钥位数（二进制位）越长越难被破解.
  2. 目前，人类历史上破解的最长RSA密钥是768位.
    - 一般使用1024位基本安全，如果是2048位则及其安全，不存在被破解的可能性.
    - 一般GitHub的SSH验证的RSA密钥长度可定义为4096位，根本没有破解的可能性.

<br><br>

### 二、RSA基本原理简介：
> RSA算法本身非常简单，仅仅利用了数论中的欧拉函数和欧拉定理.
>
>> 它巧妙地将因数分解作为破解密钥的唯一手段，而极大整数的因式分解复杂度几乎无穷大.
>>   - 从而大整数的情况下使得密钥无法被破解.

- RSA产生公钥/私钥的算法流程：
  1. **随机选择** 两个不相等的质数P和Q.
    - 假设P = 61, Q = 53
  2. 计算P、Q乘积n作为**大整数**：
    - n = P × Q = 61 × 53 = 3233
    - n的二进制位数就是RSA密钥的长度.
      - 这里3233的二进制长度是12，因此这个案例中RSA密钥的长度为12.
      - RSA密钥长度一般为1024，重要场合则为2048，超高保密场合为4096.
  3. 计算**大整数**n的欧拉函数：euler(n)
    - euler(n) = [1, n)中和n互质的数的个数.
    - 根据欧拉定理，当n可以分解为两个质数（P和Q）的乘积时euler(n) = (P-1) × (Q-1)
    - 因此，这里euler(n) = euler(3233) = (61-1) × (53-1) = 3120
  4. **随机选择** 区间(1, euler(n))中的一个整数pub，要求pub和euler(n)要互质.
    - 这里选择pub = 17
    - **n和pub两个整数就作为公钥**.
  5. **随机选择** 一个pub对于euler(n)的模反元素pri.
    - x对a的模反元素x_的定义是：x*x_ % a = 1
      - 由于x_必须是整数，因此需要通过一定技巧求解，这里可以通过扩展欧几里得算法轻松求出解的集合.
      - 然后从集合中随机挑选一个值作为模反元素即可.
    - 因此这里就是求pub * pri % euler(n) = 1的一个随机解
    - 这里选择pri = 2753
    - **n和pri两个证书就作为私钥**.

<br>

- 如何破解私钥？
  1. 密钥：加粗的表示已知的，不加粗的表示未知的
    - 公钥：**n**, **pub**
    - 私钥：**n**, pri
  2. 私钥的n和pri必须要保管好，但由于公钥中也有n，因此私钥真正保管的其实是pri.
  3. 破解私钥：就是如何通过已知的n和pub来计算出pri.
    - 先总结回顾密钥对的生成过程：加粗表示已知，其余是未知的
      1. **n** = PQ
      2. euler(n) = (P-1)(Q-1)
      3. (**pub** × pri) % euler(n) = 1
    - 破解思路：
      1. 观察**[3.]** 式得出，只要能求出euler(n)就能破解pri了，所以破解的关键就是求euler(n).
      2. euler(n)可以根据欧拉函数的定义求（[1, n)之间和n互质的数的个数），但是直接根据定义求复杂度非常高，逐个枚举太慢.
      3. 但我们事先知道RSA算法要求n是两个不相等质数P和Q的乘积，而欧拉函数的特殊性质告诉我们式**[2.]**
        - 即euler(n) = (P-1)(Q-1)
      4. 因此目标就变成了求P和Q，而P和Q只能从式**[1.]** 计算出，就是对整数n进行因数分解.
    - 但事实告诉我们，如果n足够大，即**大整数**，因式分解几乎是不可能的！！即复杂度趋向于无穷大.
      - 目前人类成功因式分解的大整数的最大长度只有768位（二进制位）.
      - 因为这个原因，**保证了RSA私钥的不可破解性**.

<br>

- 加密解密：还是假设x是明文，y是密文
  - RSA同时满足：
    1. 公钥加密私钥解密：y = x^pub % n, x = y^pri % n
    2. 私钥加密公钥解密：y = x^pri % n, x = y^pub % n
  - 因此RSA是非对称加密算法：
    1. 可逆的：公钥私钥都能加解密.
    2. 公钥私钥之间相互推导不可能完成.

<br><br>

### 三、复杂度分析：

1. 构造密钥对：
  1. **n** = PQ     # P、Q随机生成，做一次乘法
  2. euler(n) = (P-1)(Q-1)  # 做一次乘法
  3. (**pub** × pri) % euler(n) = 1  # pub随机选择，做一次扩展欧几里得
    - 总体来说就是两次乘法和一次扩展欧几里得，简单到不行.
2. 加解密：
  - 算式就是：b = a^key % n
  - 就是算幂a^key的步骤复杂度比较高.
    - 当n较大时key也会比较大，因此加解密过程效率不高.

<br>

- 总体评价：构造密钥对复杂度极低，加解密过程复杂度较高.
