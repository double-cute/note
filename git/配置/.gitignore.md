# .gitignore
> 指定工作区中有哪些文件不被git本版控制.
> - 特别是.o、.lib等编译中间产物，不希望被版本库记录.

<br><br>

## 目录
1. [什么是不受版本控制的文件：跟踪文件的概念](#一什么是不受版本控制的文件跟踪文件的概念--)
2. [.gitignore的作用](#二gitignore的作用)
3. [远程共享：共享模式](#三远程共享共享模式--)
4. [独享模式及其作用域](#四独享模式及其作用域)
5. [忽略文件的语法](#五忽略文件的语法)

<br><br>

### 一、什么是不受版本控制的文件：跟踪文件的概念  [·](#目录)

- 跟踪文件：
  - 就是被git版本库跟踪的文件.
  - 具体是指被**记录在版本库的分支树中**的文件，可以在分支树中查看到这些文件的历史.
- 跟踪文件就是受git版本控制的文件.
- git如何实现文件的跟踪？
  1. 非常简单：只要是**被加到stage过**的文件都将被跟踪.
  2. 可以将文件加入stage的git命令都可以用来对文件进行跟踪，典型的有git add、git rm、git mv等**跟踪命令**.
    - 这里指的是一整个系列，比如git add，就包括git add -u、git add -A等所有这一系列的命令.
  3. 所有能产生跟踪文件效果的命令都称为**跟踪命令**，git add就是一个典型的跟踪命令.

<br><br>

### 二、.gitignore的作用：[·](#目录)
> 里面记录的文件即使用git add等跟踪命令也无法将其加入stage，即：
>   - **使跟踪命令也无法跟踪.gitignore中列举的文件**.

1. 强制跟踪：git add -f
  - 如果被.gitignore忽略的文件还是想强行跟踪它，则只能使用：git add **-f** 强行被跟踪的文件
  - f就是force的意思，表示强制，该命令强行将指定文件加入stage，不管.gitignore是否记录.
  - **注意：** 一旦被加入过stage，那**不管.gitignore记录没记录**都将被跟踪.
    - 因此.gitignore只对**未被跟踪**的文件有效，一旦被跟踪了，.gitignore就无效了！
2. 强制查看工作区中哪些文件还未被跟踪：git status **--ingored**
  - 一般用git status --ignored -s简化显示，其中：
    1. ??表示未被跟踪的文件：.gitignore没记录但是还未被跟踪的文件.
    2. !!表示被忽略的文件：.gitignore记录的且没被强制跟踪的文件.
      - 单纯的理解为未被跟踪以及被忽略即可，简单明了.

<br><br>

### 三、远程共享：共享模式  [·](#目录)

- 如果.gitignore**放在工作区中**则将和远程版本库共享：
  1. 只要不放在.git/目录中的工作区的其它任意位置，都会被git扫描到.
  2. 这样的.gitignore文件**本身会被git版本库跟踪**.
    - 因此，git pull/push的时候.gitignore也会被传递.
    - 所以远程和本地版本库都会生效.
    - **缺点：** 远程、本地版本库交流的时候.gitignore会相互合并，不利于协同开发.
- 这种模式称为**共享模式**.
  - 与之对应的就是独享模式，即**只在本地版本库中生效**，但不会被推送到远程版本库（不会在远程生效）.

<br><br>

### 四、独享模式及其作用域：[·](#目录)
> 前面讲过了，独享模式下的忽略文件只对本地生效，不对远程生效.

- 如何定义独享的忽略文件呢？共有三种作用域：和git配置文件的三种作用域完全相同

| 作用域 | 设置 | 说明 |
| --- | --- | --- |
| 局部仓库 | [repo]/.git/info/exclude | 文件名固定为这个 |
| 单独OS用户全局 | git config --global **core.exludesfile** 文件名 | 文件名自取 |
| OS全部用户全局 | git config --system **core.exludesfile** 文件名 | 文件名自取 |

- 即局部仓库作用域下，忽略文件的路径是固定的（.git/info），文件名也是固定的（exclude）.
- 全局作用于下忽略文件的位置可以自己随意安排，名字也是自取，需要配置到git的core.exludesfile属性中.

<br>

- 覆盖范围是共享模式最小，因此同名覆盖顺序是：
  1. 共享  ->  独享
  2. 独享中：小范围  ->  大范围
- 所以，**两种模式如何抉择：**
  1. 共享模式的.gitignore中记录那些协作开发的规范忽略文件.
    - 是协作开发小组一致认定的基础规范.
    - 项目初始阶段就订好，最好不要在后期更改.
    - 即基础规范.
  2. 独享模式：组内成员自己管自己开发时根据自己的习惯和调试代码的情况自行定义.
    - 主要是方便自己.
    - 发布到远程分支时一定要和共享的.gitignore保持一致.

<br><br>

### 五、忽略文件的语法：[·](#目录)

1. \#表示单行注释.
  - 注释行以及空行都将被忽略.
2. 一行定义一条忽略规则.
3. 可以使用正则表达式进行匹配，常用的有：
  1. \*：0个或多个.
  2. ?：1个.
  3. [abc]：表示单个字符的范围.
4. 特殊字符：
  1. !：不忽略.
  2. /开头：忽略目录表层，不递归.
  3. /结尾：递归忽略整个目录.

<br>

- 示例：

```
# 注释

# 忽略所有.a文件，但不忽略lib.a文件
*.a
!lib.a

doc/*.txt   # 忽略doc/目录下的所有.txt文件

/TODO       # 只忽略TODO/目录下的文件，但不递归往下忽略其中的子目录中内容
build/      # 递归忽略build/目录下的所有文件，包括子目录中的所有内容
```
