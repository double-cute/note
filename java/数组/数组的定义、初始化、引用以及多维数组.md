# 数组的定义、初始化、引用以及多维数组
> Java数组原始、底层、高效，是JVM内核的一部分.

<br><br>

## 目录：

1. [Java数组的主要特点](#一java数组的主要特点)
2. [用数组类型声明引用](#二用数组类型声明引用)
3. [数组初始化](#三数组初始化)
4. [多维数组](#四多维数组)
5. [使用数组](#五使用数组)

<br><br>

### 一、Java数组的主要特点：[·](#目录)

<br>

1. **特别低级和底层，是JVM内核的一部分**，因此效率极高、操作及其简单.
2. 由于数组极底层的实现，最好 **只用数组存放基本类型元素**，因为 **它跟Java的一些高级类型（特别是泛型等）兼容得不好甚至完全不兼容**.
3. Java数组也具有所有编程语言数组的基本特性：
   1. **元素类型一致**：编译时就已经确定了数组中所有元素的类型.
   2. **定长**：编译时就已经确定了数组的长度，在运行时无法改变其长度.
4. Java数组的面向对象特点：
   1. 是一种彻彻底底的 **引用类型**.
   2. 虽然底层的驱动是C语言，但还经过了一轮简单的面向对象包装，可以通过类、对象的方式操作数组.
      - 目的是进一步 **简化数组的操作（以面向对象的方式）** ，并 **增加使用的安全性**（面向过程的操作数组的方式有极大的安全风险）.
   3. 提供边界检查 **[ArrayIndexOutOfBoundsException]**，越界访问会有明显的异常提示，debug再也不用担心了.
5. Java数组 **长度可以动态确定**：
   - 不像C/C++那样，长度必须在编译时就确定（用一个常量确定）.
   - Java数组长度可以用一个变量来确定：scan len; new Integer[len];
      - 即可以随着程序的运行动态地确定数组的长度.
      - 但是一旦确定了 **仍然是定长的，之后不能再改变它的长度**.

<br><br>

### 二、用数组类型声明引用：[·](#目录)

<br>

- 支持两种风格：
   1. Java面向对象风格：type[] arrayName;
   2. 传统的C语言格式：type arrayName[];  // 为了满足C开发者的编程习惯，但不推荐
      - 第一种风格更佳，见名知意，一看就知道 **type[]是一种数组类型**，C风格容易让人混淆，应该抛弃.

<br>

**注意：**

1. type[]表示的是一种类型，叫数组类型，因此不能在[]中指定数组长度，否则编译错误.
   - 例如：int[5] iarr;  // 错误
2. 声明数组类型引用变量的部分不能出现任何和初始化相关的内容.
   - 指定数组长度属于**数组初始化**的工作.

<br><br>

### 三、数组初始化：[·](#目录)
> 支持两种初始化方式，静态和动态.

<br>

**1.&nbsp; 静态初始化：**

> 静态的意思是：开发者自己显式指定数组中每个元素的初始值.

- 规则是：
   1. **不能指定** 数组长度.
   2. **必须指定** 每个元素的初始值.
      - 既然不能指定长度，那么编译器自然是**根据给出初始值的元素个数来推断数组的长度**咯.
- 这个看似奇葩的规则其实是有道理的：
   1. 既然能从初始值个数来推断出数组长度那何必还要多费功夫地再显式指定数组长度呢？
   2. 如果哪天需要增加元素了，那么既要添加初始值，又要重新数数组元素个数以更新长度，岂不是增加了工作量吗？
   3. 更何况有可能数错了呢.

<br>

- 示例：

```Java
arr = new Integer[] { 1, 2, 3, 4 };
arr = new Integer[4] { 1, 2, 3, 4 };  // 错误！不能指定数组长度
arr = new Object[] { 1, 3.4, "abc" };  // 正确！灵活利用继承特性
```

<br>

- 特殊的规则：如果声明数组变量的 **同时** 进行静态初始化，则可以进一步省略掉new type[]，**还是为了照顾C开发者的开发风格**
   - **不同时是不行的**，会编译错误.
   - 毕竟，数组类型可以通过变量的编译时类型确定.
   - 但 **还是推荐正常的Java风格**，保持良好的风格一致是非常重要的！

```Java
Integer[] iarr = { 1, 2, 3, 4 };  // 正确！这其实也是一种照顾C开发者的做法，沿袭了C的简化风格
Object[] oarr = { 1, 3.4, "abc" };  // 正确！灵活利用继承特性

Integer[] iarr;
iarr = { 1, 2, 3, 4 };  // 错误！简化风格必须在声明变量同时初始化，分开就不行了，编译错误！！
```

<br>

**2.&nbsp; 动态初始化：**

- 规则：只指定数组长度，不给出元素的初始化值.
   - 编译器默认给出二进制0作为初始化值（boolean是false、基本数值型是0/0.0、引用类型是null）.
- 示例：
   1. arr = new Double[20];  // 静态确定长度
   2. int len = 5; len = scan.next(); arr = new Integer[len];  // 动态确定长度

<br>

**3.&nbsp; 静态和动态的主要差别：**

1. 静态的意思是指：**数组长度在编译时就已经确定.**
   - 给出初始值的元素是确定的，个数是确定的，因此编译时就能确定数组长度.
   - 这就跟C语言里必须用一个常量来指定数组长度是一个道理.
2. 动态的意思是指：**数组长度可以用一个变量来确定.**
   - 既然是变量，那么变量随着程序运行而改变，因此数组长度是动态确定的，无法在编译时就确定长度.
   - 当然也可以直接用一个常量去静态地确定长度.
3. 应用场合：
   - 静态：小规模数据（程序配置数据等）.
   - 动态：大规模数据（未初始化，作用就是一段空间，一段缓存，特别原始的C语言用法）.
4. 两种初始化风格不要混用，否则编译报错：
   - 例如：Integer[] iarr = new Integer[5] { 1, 2, 3, 4, 5 };  // 编译错误！
   - Java对这两种风格的意义和功能分工明确，不要想当然.

<br><br>

### 四、多维数组：[·](#目录)
> Java在 **语法上** 是 **支持多维数组** 的，但底层还是使用一维数组来模拟多维数组的（多维数组其实就是一维数组的多层嵌套）.
>
>> 例如：二维数组就是一维数组的每个元素又是一个一维子数组，两层一维数组的嵌套就是二维数组，n层嵌套就是n维数组.

<br>

- 定义以及初始化语法：
   - 类型表示：type[][][]...   // 越前面的[]表示越高维
   - 初始化和一维数组一致，但不过要注意一点：还是 **静态和动态初始化不能混用**！
      - 只要[][][]...中有任意一个[]给出了长度，那就默认是动态的了！！一旦是动态就不能给出任何显式初始化值！！！

<br>

- 示例：

```Java
int[][] a = new int[][] { new int[3], new int[] { 1, 2, 3 }, { 3, 4, 5 } }; // 正确
int[][] b = { new int[3], new int[] { 1, 2, 3 }, { 3, 4, 5 } };  // 正确
int[][] c = new int[2][];  // 正确
int[][] d = new int[][3];  // 错误！动态初始化时不能在没指定高维长度的情况下指定低维长度
int[][] e = new int[2][3]; // 正确
int[][] f = new int[2][] { new int[3], new int[4] }; // 错误！！动静混用！
```

<br><br>

### 五、使用数组：[·](#目录)
> 使用方法和C语言基本一样，使用[]索引数组中的元素，访问以及修改.
>
>> 例如：arr[0] = 1.5;

<br>

- 数组类型的属性以及方法：
   - 由于数组太底层了，仅仅就是一层简单的面向对象包装.
   - 因此，**方法全部都是从Object继承而来的**.
   - **仅仅就是多了一个length属性**：**arr.length**;  // 返回数组长度.
      - 常用语循环迭代.

```Java
int length;  // 长度，以数据域保存
boolean equasl(Object o); // 元素对应一一相等，但是会空指针异常！
```

<br>

- **Java 5的forEach迭代：**
   - Java 5引入了新的数组、集合迭代方法forEach，和Python的语法相似：

```Java
for (type varName: array) { ... }
```

1. varName是一个临时变量，用于迭代地临时接收数组/集合中的元素.
   - 因此 **不能用于改变数组元素的值**，相当于数组的视图.
2. type必须要和数组/集合中元素的类型相匹配.

- 示例：

```Java
int[] arr = new int[] {1, 2, 3, 4, 5};
for (int v: arr) {
    v = 6; // v只是临时变量，无法修改数组元素本身的值
}
for (int v: arr) {
    System.out.println(v);  // 输出的还是1 2 3 4 5
}
```
