# 归属、基本权限、特殊权限
> 任何用户对于一个项目来说，在Linux系统中有且仅有3种身份中的一种：
>
> 1. 属主.
> 2. 属组.
> 3. 其他.

<br><br>

## 目录

1. [从ls -l的输出解释 归属 & 基本权限]()
2. [文件 & 目录 权限的意义]()
3. [项目的特殊权限：SUID、SGID、SBIT]()

<br><br>

### 一、从ls -l的输出解释 归属 & 基本权限：[·](#目录)
> ls -l输出的第1列的 **2-10这9个字符** 表示主体对该项目的 **读写执行权限**.
>
> - 读、写、执行 只属于基本权限，还有特殊权限
>
>> 3、4列分别表示该项目的 **属主** 和 **属组**.
>>
>> - 其中属主表示 **某1个Linux账户**，属组表示 **某1个Linux用户组**.

<br>

**1.&nbsp; 输出示例：**

| 第1列[2-10]字符（读写执行权限）| 第3列（属主）| 第4列（属组）|
| --- | --- | --- |
| rwxr-xr-- | root | root |

- 表示：
   1. 属主root对其有全部权限.
   2. 属组root中的所有成员（除了root用户自己）对其只有读、执行权限.
   3. 其它所有用户（属主、属组之外的）对其只有读的权限.

<br>

**2.&nbsp; 读写权限字符的位置和意义：**

- 3个一组，**相对位置是固定的**（顺序一定是 **读r、写w、执行x**）
   1. 第1组：**属主** 对该项目的读写执行权限.
   2. 第2组：**属组** 对该项目的读写执行权限.
      - 由于一个用户可以属于多个组，因此这里精确地讲是，组里除了属主之外的其它用户.
      - 属主不一定在属组中的哟！
   3. 第3组：**其它主体** 对该项目的读写执行权限.
      - 是指，除了属主和属组全体成员之外的所有用户.
- 符号意义：
   1. r：拥有读权限.
   2. w：拥有写权限.
   3. x：拥有可执行的权限.
   4. -：该位置没有相应的权限.

<br>

**3.&nbsp; 归属和权限的实际意义：**

1. 用户扮演不同的角色：普通用户、root用户等.
2. 不同用户应该管控不同范围的资源：特别是管理员root，只有它才能使用一些系统级的关键资源.
3. 不同项目 分配 不同的归属和权限 可以有效划分用户的角色并配置系统资源.
   - 例如：一般命令所有用户都能使用，特殊的系统级别的命令（开关机、重拨等）只能让root使用.

<br><br>

### 二、文件 & 目录 权限的意义：[·](#目录)

<br>

- 可以这样形象地理解目录的权限：
   1. 目录是一种特殊的文本文件（**后面称为dir.txt**），里面记录了目录底下所有文件和子目录名字（一行一条）.
   2. 因此目录对应的rwx权限就是对应了 **该特殊文本文件的rwx权限**.

<br>

| | 文件 | 目录 | 目录权限地形象解释 |
| --- | --- | --- |
| r | 读取文件中的内容 | 浏览目录结构（可ls查看其中内容）| 读取dir.txt中的内容 |
| w | 编辑、修改文件中的内容（**不包含删除**）| 新建、**删除**、重命名其中的文件和子目录 | 编辑、修改dir.txt中的内容 |
| x | 可以执行该文件 | 可以进入该目录（可cd进去）| - |

<br><br>

### 三、项目的特殊权限：SUID、SGID、SBIT  [·](#目录)
> 除了r、w、x三种基本权限外，对于项目还存在SUID、SGID、SBIT这3中特殊权限.
>
> - 其对应的字符分别是：s(S)、s(S)、t(T)
>    - 其中大写形式表示 **空的权限**.

<br>

**1.&nbsp; SUID：**

1. 只能出现在 **属主的x权限位置**，且只能加在 **文件** 上. （**拒绝加在目录上**）
2. 含义是：
   1. 如果某个用户对该项目 **具有可执行权限x**.
   2. 那么他在 **执行该文件时** 将 **临时拥有** 该文件 **属主的权限**.
      - 即临时地（只在执行它时）set该用户的UID为该文件属主的UID.
      - 因此SUID就是SET UID的缩写.
3. 符号的含义：
   1. s：x+s，不仅属主本人具有可执行权限，该文件也具有SUID特性.
   2. S：-+s，属主本人**不具有**可执行权限，但强行给该文件加上了SUID特性，因此是个**空的SUID特性**.
      - 实际没有SUID的功能，即空的s.
4. 示例：
   1. /usr/bin/passwd这个命令的权限和归属是：rw**s**r-xr-x root root
      - 因此**所有人都可以执行它**.
   2. /etc/shadow这个文件只能以root身份运行passwd才能修改它.
   3. 如果passwd命令的属主权限是rwx的话，那么普通用户想修改/etc/shadow就**只能以普通用户的身份运行passwd**，那就修改不了/etc/shadow了.
   4. 但passwd的属主权限是rw**s**，这就意味着普通用户运行它时可以**临时set uid为passwd的属主root**，这就可以成功修改/etc/shadow了.
   5. 这就是为什么普通用户也可以修改自己的账号密码的原因了.

<br>

**2.&nbsp; SGID：**

1. 只能出现在 **属组的x权限位置**，对于 **文件和目录** 都有效.
2. 含义是：
   1. 对于文件：
      1. 如果某个用户对该文件 **具有可执行权限**.
      2. 那么他在 **执行该文件时** 将 **临时拥有** 该文件 **属组的权限**.
         - 即临时地set该用户的GID为该文件属组的GID.
         - 因此SGID就是SET GID的缩写.
   2. 对于目录：
      1. 如果某个用户对该目录 **具有可执行权限**. （可以cd进去）
      2. 那么该用户在该目录下的 **有效用户组** 将 **临时变成该目录的属组**.
         - 通俗地讲就是，该用户在该目录中所有新建的项目的属组都为该目录的属组.
3. 符号含义：
   1. 和SUID一样，s表示属组自己拥有x的同时还额外拥有SIGD的特性.
   2. 而S则表示空的SGID（属组本身都不具有x，那强行赋予SGID特性也是徒劳的，表示空的）.
4. 示例：
   1. 对于文件：
      1. mlocate.db只支持用locate程序以slocate用户组的身份读取.
      2. 但是locate程序的权限和归属为：rwx--s--x root slocate
      3. 任何人都可以执行它，并且执行它的时候会将执行者的GID身份临时设置为slocate.
      4. 这样就可以让任何人都能以slocate的用户组身份去运行locate程序并读取mlocate.db文件了.
   2. 对于目录：**协同开发**
      1. 本来A和B两个人在不同的组GA和GB中. （意味着他俩的有效用户组分别是GA和GB）
      2. 现在老板临时把他俩叫来合伙开发一个项目PROJ.
         - 因此，把他们俩有分配到了新的组PROJ中了.
      3. 于是建了一个新目录dir_proj（归属当然root PROJ），那么该目录的权限如何设置才合理呢？
         1. 如果是rwxrwx---的话：
            1. A新建一个文件后会将权限设置成rwxrwx---，但归属没法自己改变，只能是A GA.
            2. 现在B想协同修改该文件，由于B既不是A，也不属于GA，那就没法协同开发该文件了.
         2. 所以必须改成rwxrws---：
            1. 这样A新建文件后归属自动变成A **PROJ**.
            2. 而B也属于PROJ组，因此就能顺利协同开发该文件了.

<br>

**3.&nbsp; SBIT：**

1. 只能出现在 **其他人的x权限位置**，**只对目录有效**.
2. 含义是：
   1. 如果某个用户对该目录 **具有可执行权限**. （可以cd进去）
   2. 那么 **只有root和该用户自己** 才能 **删除、重命名自己创建的项目**，别人不能这样对待你创建的项目.
      - 这直接涉及到安全性.
      - SBIT即Sticky Bit的简称，即**粘滞位**，让项目和自己粘住，别人抢不走它了！
3. 符号含义：
   1. t：x+t，其他人具有x权限的同时也具有SBIT特性.
   2. T：-+t，其它人本身不具有x权限，但强行加上SBIT特性那也是徒劳的，是空的！不起作用.
4. 示例：
   1. /tmp目录的权限和归属为：rwxrwx**r**wt root root
   2. 这就意味着，任何人都可以进入该目录并创建属主是自己的项目. （同时也能看到其它人创建的项目）
   3. 但只有自己和root能删除或者重命名自己创建的项目，但不能删除、重命名其它人的项目.
      - **但并不表示不能修改别人的东西（还是要看那个项目的具体权限）.**
