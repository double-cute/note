# redis-cli的基本交互命令 & Redis实例模型
> 和其它数据库一样，都使用一个最基本的交互工具和数据库连接并操作数据库中的数据.
>
>> Redis使用redis-cli命令行客户端完成上述工作. （**通过Redis的内部命令完成**）
>
> - Redis所有的内部命令（相当于SQL数据库的SQL语句）不区分大小写，并且格式自由.

<br><br>

## 目录

1. [和Redis交互的两种形式](#一和redis交互的两种形式)
2. [内部命令作为redis-cli参数](#二内部命令作为redis-cli参数)
3. [检测是否连接成功：ping](#三检测是否连接成功ping--)
4. [Redis命令的返回值](#四redis命令的返回值)
5. [Redis数据库的实例模型：重要！](#五redis数据库的实例模型重要-)

<br><br>

### 一、和Redis交互的两种形式：[·](#目录)

<br>

1. 将Redis内部命令作为redis-cli的参数直接在Shell命令行执行.
   - 这种方式的特点：
      1. 每次执行一条命令都 连接-断开 了1次. （执行时连接redis-server，执行完毕后断开）
      2. 优点：可以和Shell命令配合使用（比如把Redis的执行结果管接给其它Shell命令之类的）.
      3. 缺点：每次都需要多输入一个redis-cli，就跟git命令一样，必须要git加上git内部命令.
         - 例如：
            - redis-cli shutdown   类似于   git commit   好比是   mysql source ...(只不过不支持)
2. 进入redis-cli交互界面，直接输入内部命令进行交互即可：
   - 直接输入redis-cli并回车就进入了redis-cli交互界面了.
   - 在交互界面中输入命令不用加行redis-cli了.
   - 优点很明显：不用每次输入命令都要连接-断开了，并且不用麻烦地多写一个redis-cli.
   - 缺点就是在交互界面中不能执行外部的Shell命令，不能和Shell命令配合使用.

<br><br>

### 二、内部命令作为redis-cli参数：[·](#目录)
> 这种方式在生产环境中更常用，毕竟可以和外部Shell命令等配合完成更加多变、复杂的功能.
>
>> 而一般交互模式只用于局部观察、调试和学习.

<br>

**每一次执行都是一次 连接-断开：**

- 而和数据库连接必然少不了 host:port:user:passwd 等要素.
- 默认情况下会以配置文件redis.conf中设定的值去连接，但实际也可以临时指定：

```Shell
$ redis-cli -h 127.0.0.0 -p 6379 [...其它连接配置] Redis内部命令
```

<br><br>

### 三、检测是否连接成功：ping  [·](#目录)

<br>

- 在"redis-cli 内部命令"的形势下，如果没连接上是执行不了命令的，会直接报错.
- 而在交互界面下，即使没连接上也不会直接提示，但没连接上就直接执行命令也会直接报错的.
   - 这和MySQL等区别很大，MySQL没连接上都进入不了交互界面！

<br>

- Redis使用ping命令检测是否和server成功连接，如果回复PONG则表示连接成功.
- 示例：

```Shell
$ redis-cli ping
PONG
```

<br><br>

### 四、Redis命令的返回值：[·](#目录)
> 主要有4种：状态回复、错误回复、整数回复、字符串回复.

<br>

1. 状态回复：
   - 一般回复的都是一个 **没有用""括起来的单词**，表示命令执行的状态.
      1. 如ping-回复PONG，set键名-回复OK等，主要用于 **表示命令执行是否成功**.
      2. 也有回复其它信息的，比如数据类型等（使用type检测数据类型，会回复string、list等）.
2. 错误回复：
   1. 回复以 **(error)** 开头，后面跟上错误的具体信息.
   2. 一般在 **命令不存在、命令使用错误** 时做出这种回复.
3. 整数回复：
   1. 以 **(integer) 数字** 开头，后面有时会跟上额外的说明信息.
   2. 一些操作整数的命令会回复整数操作完成之后的新值，比如自增命令incr等.
4. 字符串回复：
   1. 是最常见的回复，一般用来查看数据的值（字符串类型）.
   2. 共有3中形式：
      1. 回复单个字符串（比如只查看某个键的string类型单值）："字符串值"
      2. 回复多个字符串（查看散列值）：每行一条字符串，以行号开头（从1计），例如其中一行 **2) "字符串值"**
      3. 回复空值（某个键不存在，但还是强行查看）：**(nil)**

<br><br>

### 五、Redis数据库的实例模型：重要！ [·](#目录)
> 这里可以非常形象地和SQL数据库做类比就知道两者的概念了.

<br>

| | SQL | Redis | 说明 |
| --- | --- | --- | --- |
| 数据库实例 | database(create database XXX) | dictionary | 1个字典就相当于SQL的1个数据库实例 |
| 数据库实例中的数据单位 | table(create table XXX) | key-value | 1对key-value就相当于SQL的1张表 |

<br>

- Redis的模型特点：
   1. 不支持对数据库实例命令.
      - 这和SQL的差别很大，SQL可以用create database XXX的方式命名.
   2. Redis强制用一个从0计的数字对每个数据库实例命名.
      - **默认只有16个实例（0-15），单可以通过修改redis.config中的databases参数来修改这一数字.**
      - 可以使用 **select** 命令自由切换当前使用的数据库实例，例如：**redis-cli select 5**
   3. Redis不支持对每个数据库实例分别设置权限和密码.
      - 因此要么一个用户可以访问全部实例，要么一个都访问不来.
   4. 实例之间并不完全隔离，可以通过一个flushall命令清空所有实例！

<br>

- 总结特点：
   - Redis数据库实例更像一种 **命名空间**.
   - 应该把 **1个应用** 的 **不同类型数据** 放在 **1个Redis数据库** 的 **不同实例（字典）** 里.
      - 总结来说良好的设计习惯：1个数据库对应1一个应用，数据库中的不同实例（字典）对应应用的不同类型数据.
      - 例如：
         - 把应用A的生产数据放在0中，测试数据放在1中.
         - 但不要把A的生产数据放在0中，把B的生产数据放在1中.
